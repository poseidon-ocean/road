#B 树

## 什么是B-树
* Mysql数据库索引是基于什么数据结构
* 索引主要是基于Hash表或B+树
* B-树就是B树，中间的横线不是减号

## 数据库索引为什么使用树结构存储？
* 树的查询效率高，而且可以保持有序
* 为什么索引没有使用二叉树来实现
	* 从逻辑上来讲，二叉查找树的查找速度和比较次数都是最小的，但要考虑磁盘IO的问题
	* 数据库索引是存储在磁盘上的，当数据量比较大的时候，索引的大小可能有几个G甚至更多
	* 当我们利用索引查询的时候，不能把整个索引加载到内存，只能逐一加载每一个磁盘页
	* 磁盘IO的次数是由索引树的高度决定的，最坏的情况是次数等于索引树的高度
	* 为了减少磁盘IO次数，把原本“瘦高”的树结构变得“矮胖”，这是B树
* B树是一种多路平衡查找树，它的每一个节点最多包含k个孩子，k被称为B树的阶，k的大小取决于磁盘页的大小

## 一个m阶的B树特征
* 1.根节点至少有两个子女
* 2.每个中间节点都包含k-1个元素和k个孩子，其中m/2<=k<=m
* 3.每一个叶子节点都包含k-1个元素，其中 m/2 <= k <= m
* 4.所有的叶子结点都位于同一层。
* 5.每个节点中的元素从小到大排列，节点当中k-1个元素正好是k个孩子包含的元素的值域分划。
* 相比于磁盘IO，内存中的比较耗时几乎可以忽略
	* 只要树的高度足够低，IO次数足够少，就可以提升查找性能
* 自平衡：B-树能够始终维持多路平衡
* B-树主要应用于文件系统以及部分数据库索引，如MongoDB
* 大部分关系型数据库，使用B+ 树作为索引，如MySQL

## 什么是B+树
* B+树是基于B-树的一种变体，有着比B-树更高的查询性能

## 一个m阶的B+树具有如下几个特征
* 1.有k个子树的中间节点包含有k个元素（B树中是k-1个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点。
* 2.所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接。
* 3.所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素。

## B+树的特征
* 1.有k个子树的中间节点包含有k个元素（B树中是k-1个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点。
* 2.所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接。
* 3.所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素。

## B+树的优势：
* 1.单一节点存储更多的元素，使得查询的IO次数更少。
* 2.所有查询都要查找到叶子节点，查询性能稳定。
* 3.所有叶子节点形成有序链表，便于范围查询。




> https://www.cs.usfca.edu/~galles/visualization/Algorithms.html
> http://mp.weixin.qq.com/s/rDCEFzoKHIjyHfI_bsz5Rw
> https://mp.weixin.qq.com/s/jRZMMONW3QP43dsDKIV9VQ


